<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Readiness Game - Microsoft Power Platform</title>
  <!-- Include jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Optional favicon to silence local resource warning; replace with your favicon path if available -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    /* Reset default margins and padding */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* Body and background */
body {
    /*background-color: #0078d4; /* Blue background from the UI */
    font-family: 'Segoe UI', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
    color: white;
    background-image: url('BG.png');
    /* Optional properties for fine-tuning */
    background-size: cover; /* Scales the image to cover the entire div, may crop parts */
    background-position: center; /* Centers the image in the div */
    background-repeat: no-repeat; /* Prevents the image from repeating */
}

/* Main game container */
.game-container {
    width: 1200px; /* Fixed width for desktops/laptops */
    padding: 20px;
}

  /* header for logo and card counter */
  .header {
    width: 100%;
    height: 125px;
  }

    .header-left {
      width: 75%;
      position: relative;
      float: left;
    }

      .header-left img {
        width: 200px;
        height: auto;
      }
    
    .header-right {
      width: 25%;
      position: relative;
      float: left;
      height: 100px;
    }

      .game-runtime {
        width: 300px;
        height: 50px;
        position: relative;
      }

        #runtime, #cards {
          background-image: url('Remaining.png');
            /* Optional properties for fine-tuning. */
            background-size:contain; /* Scales the image to cover the entire div, may crop parts */
            background-position: center; /* Centers the image in the div */
            background-repeat: no-repeat; /* Prevents the image from repeating */
        }

          #time-remaining-label, #remaining-cards-label {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            position: absolute;
            top: 15px;
            left: 15px;
            color: #2672bc;
            font-style: italic;
          }

          #time-remaining {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            position: absolute;
            top: 15px;
            left: 240px;
            color: #2672bc;
          }

          #remaining-cards {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            position: absolute;
            top: 15px;
            left: 265px;
            color: #39b54a;
          }

/* Left column (game info, current card, explanation, instructions) */
.left-column {
    /* width: 25%; */
    width: 375px;
    padding-right: 15px;
    box-sizing: border-box;
    position: relative;
    float: left;
}

.center-column {
  width: 30px;
  box-sizing: border-box;
  position: relative;
  height: 600px;
  padding-top: 495px;
  float: left;
}

/* Right column (zones and buttons) */
.right-column {
    width: 65%;
    box-sizing: border-box;
    position: relative;
    float: left;
}

.current-card-area {
  width: 350px;
  height: 240px;
  background-image: url('CardFrame.png');
    background-size:contain; /* Scales the image to cover the entire div, may crop parts */
    background-position: center; /* Centers the image in the div */
    background-repeat: no-repeat; /* Prevents the image from repeating */
  position: relative;
  box-sizing: border-box;
  padding: 20px;
}

/* Card explanation */
.card-explanation {
    padding: 30px 0px 0px 0px;
    min-height: 150px;
    overflow-y: auto;
    font-size: 12pt;
    border: none; /* Remove default border */
}

  .card-explanation strong {
    color: #f2f2f2;
  }

  .card-explanation p {
    margin: 10px 0px 10px 0px;
    font-size: 10pt;
  }



/* Instructions */
.instructions {
    padding: 10px;
    padding-left: 220px;
    color: white;
    min-height: 100px;
    font-size: 10pt;
    line-height: 1.5;
    border: none; /* Remove default border */
}

/* RIGHT ZONE */

.zones-container {
  width: 100%;
  position: relative;
  height: 550px;
}

.zone {
  position: relative;
  width: 50%;
  box-sizing: border-box;
  height: 275px;
  float: left;
}

/* Zone-specific colors and labels */

.do-now {
    grid-area: can-do-now;
    background-image: url('Green.png');
    background-size: cover; /* Scales the image to cover the entire div, may crop parts */
    background-position: center; /* Centers the image in the div */
    background-repeat: no-repeat; /* Prevents the image from repeating */
}

.do-soon {
    grid-area: can-do-soon;
    background-image: url('Yellow.png');
    background-size: cover; /* Scales the image to cover the entire div, may crop parts */
    background-position: center; /* Centers the image in the div */
    background-repeat: no-repeat; /* Prevents the image from repeating */
}

.do-later {
    grid-area: can-do-later;
    background-image: url('Red.png');
    background-size: cover; /* Scales the image to cover the entire div, may crop parts */
    background-position: center; /* Centers the image in the div */
    background-repeat: no-repeat; /* Prevents the image from repeating */
}

.done {
    grid-area: already-done;
    background-image: url('Blue.png');
    background-size: cover; /* Scales the image to cover the entire div, may crop parts */
    background-position: center; /* Centers the image in the div */
    background-repeat: no-repeat; /* Prevents the image from repeating */
}

.zone-label {
    color: white;
    margin-bottom: 5px;
    padding-left: 40px;
    font-size: 10pt; /* Adjusted to match UI text size */
    text-align: left;
    font-weight: 100;
    width: 100%;
}

/* Drop area for cards */
.drop-area {
    /* width: 100%; */
    /* min-height: 150px; */
    width: 390px;
    height: 250px;
    background-color: transparent; /* No background, just the zoneâ€™s gradient */
    padding: 27px 0pc 0pc 48px;
    box-sizing: border-box;
    overflow-y: auto;
    position: relative;
}

/* Card rows */
.card-row {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    margin-bottom: 5px;
    gap: 5px;
    min-height: 90px;
}

/* Individual cards */
.card {
    width: 160px;
    height: 170px;
    background-color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: grab;
    font-size: 12px;
    text-align: center;
    padding: 1cqmax;
    box-sizing: border-box;
    border-radius: 6px;
    white-space: normal;
    overflow: hidden;
    color: black;
    flex-shrink: 0;
    position: absolute;
    border: 1px dotted #a8a8a8;
}

/* Drag-over state for drop areas */
.drop-area.drag-over {
    background-color: rgba(255, 255, 255, 0.2); /* Slight white overlay for feedback */
}

/* Draw card button */
.draw-card-button {
    width: 200px;
    height: 200px;
    margin: 10px auto;
    padding: 15px 30px;
    border-radius: 150px;
    border: 0px;
    background-color: transparent;
    cursor: pointer;
    box-shadow: none; /* Remove default shadow */
    transition: transform 0.3s ease;
    background-image: url('DrawCard.png');
    background-size: cover; /* Scales the image to cover the entire div, may crop parts */
    background-position: center; /* Centers the image in the div */
    background-repeat: no-repeat; /* Prevents the image from repeating */
    position: absolute;
    right: -60px;
    bottom: -50px;
}

.draw-card-button:hover {
    transform: scale(1.1);
    background-color: #ffbf00; /* Slightly lighter orange on hover */
}

/* Finish button */
.finish-button {
    width: 120px;
    margin: 10px auto;
    padding: 15px 30px;
    border: 1px solid black;
    border-radius: 100%;
    cursor: pointer;
    font-size: 16px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    color: black;
}

.finish-button:hover {
    background-color: #f0f0f0;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    width: 300px;
    color: black;
    position: absolute;
    left: 40%;
    top: 35%;
}

  .modal-content h2 {
    font-weight: 100;
  }

  .modal-content p {
    font-size: 12pt
  }

.modal button {
    margin-top: 10px;
    padding: 10px 20px;
    background-color: #0078d4;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.modal button:hover {
    background-color: #005a9e;
}
  </style>
</head>
<body>
  <div class="game-container">
    <div class="header">
      <div class="header-left">
        <img src="PowerCatLogo.png" />
      </div>
      <div class="header-right">
        <div class="game-runtime" id="runtime">
          <p id="time-remaining-label">TIME REMAINING: </p>
          <span id="time-remaining">30:00</span>
        </div>
        <div class="game-runtime" id="cards">
          <p id="remaining-cards-label">REMAINING CARDS: </p>
          <span id="remaining-cards">15</span>
        </div>
      </div>
    </div>
    <div class="left-column">     
      <div class="current-card-area"></div>
      <div class="card-explanation">Card explanation will appear here after drawing.</div>
    </div>
    <div class="center-column">
      <button class="draw-card-button"></button>
      <div id="finishModal" class="modal">
        <div class="modal-content">
            <h2>Finish Sorting</h2>
            <p>Are you ready to generate the report?</p>
            <button id="confirmFinish" class="finish-button">Finish Sorting & Generate Report</button>
        </div>
    </div>
    </div>
    <div class="right-column">
      <div class="zones-container">
        <div class="zone can-do-now">
          <div class="zone-label"><p>CAN DO NOW, 6 WEEKS</p></div>
          <div class="drop-area do-now" data-zone="can-do-now"></div>
        </div>
        <div class="zone can-do-soon">
          <div class="zone-label"><p>CAN DO SOON, 3 MONTHS</p></div>
          <div class="drop-area do-soon" data-zone="can-do-soon"></div>
        </div>
        <div class="zone can-do-later">
          <div class="zone-label"><p>CAN DO LATER, 6 MONTHS</p></div>
          <div class="drop-area do-later" data-zone="can-do-later"></div>
        </div>
        <div class="zone already-done">
          <div class="zone-label"><p>ALREADY DONE</p></div>
          <div class="drop-area done" data-zone="already-done"></div>
        </div>
      </div>
      <div class="instructions">
        <p>Draw a card from the deck. Once drawn: <br>
        â€¢ Consider its relevance to your organization's Microsoft Power Platform AI readiness<br>
        â€¢ Decide and then place the card the zone it belongs to<br>
        Players use their decisions to assess the organization's AI risk management maturity.</p>
      </div>  
    </div>
  </div>
  <script>
    // Card deck with Microsoft Power Platform focus, guidance, and scores
    const deck = [
    {
    "id": "card1",
    "content": "Acknowledge AI risks exist - raise awareness",
    "score": 100,
    "description": "Start raising awareness of the various risks associated with AI-powered solutions.",
    "importance": "Acknowledging AI risk is foundational. Without this step, teams often move too quickly into experimentation without safeguards. Raising awareness helps organizations shift from assuming AI is just another automation tool to recognizing its potential for bias, misuse, privacy violations, or unintended consequences. This awareness also creates shared language and urgency across IT, business, and compliance teams.",
    "guidance": "Run an internal awareness campaign tailored to your organization's AI footprint. Include examples of risks across different tools â€” such as bias in model outcomes (AI Builder), hallucinations in Copilot responses (M365 Copilot), or improper data use. Use Microsoftâ€™s Responsible AI Principles as a framework for discussion. Start with this resource: https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/innovate/responsible-ai. You can also explore Microsoftâ€™s Responsible AI Standard here: https://www.microsoft.com/en-us/ai/responsible-ai-resources."
    },
    {
        "id": "card2",
        "content": "Nominate a responsible AI advocate",
        "score": 90,
        "description": "Start to build up a team of AI advocates. Power users, managers and executives that understand responsible AI.",
        "importance": "A clear advocate ensures that AI efforts remain visible, coordinated, and aligned with organizational values. It creates a point of accountability for AI governance.",
        "guidance": "Define the advocate role in your AI governance structure. Learn more at: https://learn.microsoft.com/en-us/azure/architecture/example-scenario/ai/responsible-ai-monitoring"
    },
    {
        "id": "card3",
        "content": "Run a bias awareness session",
        "score": 80,
        "description": "Start training teams in bias.",
        "importance": "Bias can exist in data, design, or deployment. Building awareness helps teams identify and prevent harmful or unfair outcomes.",
        "guidance": "Use Microsoft Learn: https://learn.microsoft.com/en-us/training/modules/embrace-responsible-ai-principles-practices/"
    },
    {
        "id": "card4",
        "content": "Identify one live or planned AI use case",
        "score": 50,
        "description": "Educating users on responsible AI ensures ethical and secure use of AI features.",
        "importance": "By naming specific use cases, organizations can prioritize risk management efforts and apply Responsible AI practices where it matters most.",
        "guidance": "Use the AI Use Case Assessment Template from Microsoft: https://aka.ms/raievaluationtemplate"
    },
    {
        "id": "card5",
        "content": "Make sure we can understand how our AI tools make decisions",
        "score": 70,
        "description": "Ensuring that AI decisions are explainable builds trust and transparency.",
        "importance": "Understanding how AI systems work allows users to trust the outputs and spot unintended behaviors. This is essential for transparency and compliance.",
        "guidance": "Use tools like SHAP or LIME for model explainability. See Microsoft\u2019s guidance: https://learn.microsoft.com/en-us/azure/machine-learning/concept-responsible-ai#transparency"
    },
    {
        "id": "card6",
        "content": "Create an AI risk checklist",
        "score": 75,
        "description": "Monitoring ensures that Power Platform AI solutions perform reliably and as expected.",
        "importance": "A checklist provides repeatable guardrails for risk identification, helping teams standardize oversight and reduce blind spots.",
        "guidance": "Refer to the Microsoft Responsible AI Impact Assessment Template: https://aka.ms/powercat/rai-template"
    },
    {
        "id": "card7",
        "content": "Define sensitive features in your data",
        "score": 65,
        "description": "Limiting data collection reduces privacy and security risks.",
        "importance": "Identifying sensitive features like race, gender, or age ensures these attributes are treated with care and can guide fairness assessments.",
        "guidance": "Review Microsofts data privacy and protection practices: https://learn.microsoft.com/en-us/power-platform/admin/wp-compliance-data-privacy"
    },
    {
        "id": "card8",
        "content": "Assign responsibility for monitoring models",
        "score": 60,
        "description": "Engaging stakeholders ensures diverse input and alignment with organizational goals.",
        "importance": "Monitoring can't be ad hoc - assigned responsibility ensures continuity and timely detection of risks like performance drift or bias.",
        "guidance": "Build monitoring roles into your Center of Excellence structure. Explore model monitoring with Azure: https://learn.microsoft.com/en-us/azure/machine-learning/how-to-monitor-models"
    },
    {
        "id": "card9",
        "content": "Review past model decisions for fairness",
        "score": 70,
        "description": "Adversarial testing identifies vulnerabilities in AI systems.",
        "importance": "Regular reviews of historical decisions help uncover hidden patterns of discrimination or bias in existing systems.",
        "guidance": "Use tools like Fairlearn to compare outcomes across groups: https://fairlearn.org"
    },
    {
        "id": "card10",
        "content": "Develop a model card template",
        "score": 55,
        "description": "Adhering to RAI principles ensures ethical AI use in Power Platform.",
        "importance": "A model card documents the model\u2019s purpose, performance, limitations, and ethical considerations critical for auditability and transparency.",
        "guidance": "See Microsofts documentation on model cards and responsible AI documentation: https://learn.microsoft.com/en-us/azure/machine-learning/concept-model-explanation#documenting-ai"
    },
    {
        "id": "card11",
        "content": "Plan how to handle problems or emergencies with our AI tools",
        "score": 85,
        "description": "Clear incident response plans protect operations and trust in AI systems.",
        "importance": "Without a plan, delays or confusion during incidents can lead to regulatory risk or reputational damage.",
        "guidance": "Define escalation protocols and communication plans. See Microsoft's incident response planning: https://learn.microsoft.com/en-us/security/compass/incident-response-playbooks"
    },
    {
        "id": "card12",
        "content": "Publish your AI use case inventory",
        "score": 60,
        "description": "Using methods like differential privacy enhances data protection.",
        "importance": "An inventory provides visibility into how AI is being used and ensures the right guardrails are applied to each use case.",
        "guidance": "Track Power Platform assets in the CoE Starter Kit: https://learn.microsoft.com/en-us/power-platform/guidance/coe/starter-kit"
    },
    {
        "id": "card13",
        "content": "Establish a review gate for high-risk models",
        "score": 65,
        "description": "Conducting fairness evaluations prevents bias in AI outcomes.",
        "importance": "Review gates introduce checks and balances before AI systems go live, especially for high-impact use cases.",
        "guidance": "Incorporate the Responsible AI Standard process: https://aka.ms/ResponsibleAIGuidelines"
    },
    {
        "id": "card14",
        "content": "Include AI risk in project planning",
        "score": 50,
        "description": "A transparency report details AI usage for accountability.",
        "importance": "Embedding AI risk in project planning ensures it's considered from day one, not as an afterthought.",
        "guidance": "Use Microsofts AI readiness tools and risk registers. See: https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/innovate/responsible-ai"
    }
];
    // Immutable copy of deck for lookups
    const allCards = [...deck];

    let currentCard = null;
    let gameStarted = false;
    let timeLeft = 15 * 60; // 30 minutes in seconds
    const timerElement = document.getElementById('time-remaining');
    const remainingCardsElement = document.getElementById('remaining-cards');
    const cardExplanationElement = document.querySelector('.card-explanation');
    const finishButton = document.querySelector('.modal');

    // Initialize remaining cards count
    remainingCardsElement.textContent = `${deck.length}`;

    // Track card placements by ID
    const cardPlacements = {};

    // Timer function
    function updateTimer() {
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      timerElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
      if (timeLeft > 0) {
        timeLeft--;
      } else {
        clearInterval(timerInterval);
        alert('Time is up!');
        finishButton.style.display = 'block';
      }
    }

    let timerInterval;

    // Manage card rows in drop areas (rows of 3 cards)
    function manageCardRows(dropArea) {
      const cards = Array.from(dropArea.querySelectorAll('.card'));
      dropArea.innerHTML = '';
      for (let i = 0; i < cards.length; i += 3) {
        const row = document.createElement('div');
        row.className = 'card-row';
        for (let j = 0; j < 3 && i + j < cards.length; j++) {
          row.appendChild(cards[i + j]);
        }
        dropArea.appendChild(row);
      }
    }

    // Draw a card from the deck
    function drawCard() {
      if (!gameStarted) {
        gameStarted = true;
        timerInterval = setInterval(updateTimer, 1000);
      }
      if (deck.length > 0) {
        const cardIndex = Math.floor(Math.random() * deck.length);
        const cardData = deck.splice(cardIndex, 1)[0];
        currentCard = document.createElement('div');
        currentCard.className = 'card';
        currentCard.draggable = true;
        currentCard.innerText = cardData.content;
        currentCard.id = cardData.id;
        const currentCardArea = document.querySelector('.current-card-area');
        currentCardArea.innerHTML = '';
        currentCardArea.appendChild(currentCard);
        currentCard.addEventListener('dragstart', handleDragStart);
        cardExplanationElement.innerHTML = `
          <strong>Description:</strong> <p>${cardData.description}</p><br>
          <strong>Why Itâ€™s Important:</strong> <p>${cardData.importance}</p><br>
        `;


        remainingCardsElement.textContent = `${deck.length}`;
      } else {
        alert('No more cards in the deck!');
        finishButton.style.display = 'block';
      }
    }

    function handleDragStart(e) {
        e.dataTransfer.setData('text/plain', e.target.id);
        e.dataTransfer.setData('text/content', e.target.innerText);
        // Store the initial mouse position relative to the card
        const rect = e.target.getBoundingClientRect();
        e.dataTransfer.setData('text/offsetX', e.clientX - rect.left);
        e.dataTransfer.setData('text/offsetY', e.clientY - rect.top);
    }

    // Handle drag end
    function handleDragEnd(e) {
       const content = e.dataTransfer.getData('text/content') || e.target.innerText;
       e.target.innerText = content || '';
     }
    
    // Precise dropping
    document.querySelectorAll('.drop-area').forEach(dropArea => {
      dropArea.addEventListener('dragover', e => e.preventDefault());
      dropArea.addEventListener('dragenter', e => e.target.classList.add('drag-over'));
      dropArea.addEventListener('dragleave', e => e.target.classList.remove('drag-over'));
      dropArea.addEventListener('drop', e => {
          e.preventDefault();
          const cardId = e.dataTransfer.getData('text/plain');
          const card = document.getElementById(cardId);
          if (card) {
              // Set the card's position based on drop location
              const rect = dropArea.getBoundingClientRect();
              const x = e.clientX - rect.left - (card.offsetWidth / 2); // Center the card horizontally
              const y = e.clientY - rect.top - (card.offsetHeight / 2); // Center the card vertically
              card.style.left = `${x}px`;
              card.style.top = `${y}px`;
              dropArea.appendChild(card); // Move card to drop area
              e.target.classList.remove('drag-over');
              const content = e.dataTransfer.getData('text/content');
              if (content) card.innerText = content;
              const zone = dropArea.dataset.zone;
              cardPlacements[card.id] = zone;
          }
      });
    });
    document.addEventListener('dragend', handleDragEnd);

    // Attach draw card button
    document.querySelector('.draw-card-button').addEventListener('click', drawCard);

    // Generate PDF with text wrapping
    function generatePDF() {
      if (!window.jspdf) {
        alert('jsPDF library failed to load. Please ensure an internet connection.');
        return;
      }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const pageWidth = 180; // Max width for text wrapping
      let y = 10;

      // Title
      doc.setFontSize(18);
      doc.text('Microsoft Power Platform AI Readiness Report', 10, y);
      y += 15;

      // Introduction
      doc.setFontSize(11);
      const introText = 'This report summarizes your organizationâ€™s Microsoft Power Platform AI readiness based on the card sorting results, provides guidance for uncompleted actions, and includes a score summary.';
      const splitIntro = doc.splitTextToSize(introText, pageWidth);
      doc.text(splitIntro, 10, y);
      y += splitIntro.length * 10;

      // Calculate maxScore
      const maxScore = allCards.reduce((sum, card) => sum + card.score, 0);

      // Guidance for uncompleted actions
      const notDoneCards = Object.entries(cardPlacements)
        .filter(([_, zone]) => zone !== 'already-done')
        .map(([cardId, zone]) => {
          const card = allCards.find(c => c.id === cardId);
          return card ? { ...card, zone } : null;
        })
        .filter(card => card !== null);

      if (notDoneCards.length > 0) {
        doc.text('Guidance for Uncompleted Actions:', 10, y);
        y += 10;
        notDoneCards.forEach((card) => {
          if (y > 280) {
            doc.addPage();
            y = 10;
          }
          const cardText = `- ${card.content} (${card.zone.replace('-', ' ').toUpperCase()})`;
          const splitCardText = doc.splitTextToSize(cardText, pageWidth);
          doc.text(splitCardText, 10, y);
          const guidanceText = doc.splitTextToSize(card.guidance, pageWidth - 10);
          doc.text(guidanceText, 20, y + 5);
          y += (splitCardText.length * 10) + (guidanceText.length * 10) + 5;
        });
      } else {
        doc.text('All actions are completed! No further guidance needed.', 10, y);
        y += 10;
      }

      // Maturity Assessment
      y += 10;
      const totalScore = calculateTotalScore(cardPlacements);
      const maturity = assessMaturity(totalScore, maxScore);
      const maturityText = `Your organizationâ€™s Microsoft Power Platform AI readiness maturity is: ${maturity.level} (${maturity.description})`;
      const splitMaturityText = doc.splitTextToSize(maturityText, pageWidth);
      doc.text('Maturity Assessment:', 10, y);
      y += 10;
      doc.text(splitMaturityText, 10, y);
      y += splitMaturityText.length * 10;

      // Total Score
      y += 10;
      const scoreText = `Total Readiness Score: ${totalScore} / ${maxScore} (Higher scores indicate greater AI readiness)`;
      const splitScoreText = doc.splitTextToSize(scoreText, pageWidth);
      doc.text(splitScoreText, 10, y);

      // Save PDF
      doc.save('power-platform-ai-readiness-report.pdf');
    }

    // Assess maturity based on score percentage
    function assessMaturity(totalScore, maxScore) {
      const scorePercent = totalScore > 0 ? (totalScore / maxScore) * 100 : 0;
      if (scorePercent > 80) return { level: 'Optimizing', description: 'Advanced, continuous improvement in Power Platform AI readiness.' };
      if (scorePercent > 60) return { level: 'Managed', description: 'Processes are monitored and controlled with metrics in Power Platform AI.' };
      if (scorePercent > 40) return { level: 'Defined', description: 'Standardized, documented processes are in place for Power Platform AI.' };
      if (scorePercent > 20) return { level: 'Developing', description: 'Basic awareness and some processes, but inconsistent application in Power Platform AI.' };
      return { level: 'Initial', description: 'Ad hoc and reactive; no formal processes for Power Platform AI in place.' };
    }

    // Calculate total score
    function calculateTotalScore(placements) {
      let totalScore = 0;
      Object.entries(placements).forEach(([cardId, zone]) => {
        const card = allCards.find(c => c.id === cardId);
        if (card) {
          if (zone === 'already-done') totalScore += card.score;
          else if (zone === 'can-do-now') totalScore += Math.floor(card.score * 0.75);
          else if (zone === 'can-do-soon') totalScore += Math.floor(card.score * 0.5);
          else if (zone === 'can-do-later') totalScore += Math.floor(card.score * 0.25);
        }
      });
      return totalScore;
    }

    // Attach finish button
    finishButton.addEventListener('click', generatePDF);

    // Check jsPDF availability
    if (!window.jspdf) {
      console.error('jsPDF library failed to load.');
      alert('jsPDF library failed to load. Please ensure an internet connection.');
    }
  </script>
</body>
</html>
